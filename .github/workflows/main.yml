name: Node.js Validation

on:
  push:
    branches:
      - main

jobs:
  validate:
    runs-on: ubuntu-22.04
    
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
        
      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '18'
          
      - name: Environment Validation
        run: |
          echo "=== Environment Check ==="
          node --version
          npm --version
          echo "âœ… Node.js environment ready"
          
      - name: Project Structure
        run: |
          echo "=== Project Files ==="
          ls -la
          echo "=== JavaScript Files ==="
          find . -name "*.js" -o -name "*.json" | head -10 || echo "No JS files found"
          
      - name: Initialize Project if Needed
        run: |
          if [ ! -f package.json ]; then
            echo "Initializing new Node.js project..."
            cat > package.json << EOF
{
  "name": "pitrust-infrastructure",
  "version": "1.0.0",
  "description": "PiTrust Infrastructure Protocol",
  "main": "index.js"
}
EOF
            echo "âœ… Created package.json"
          else
            echo "âœ… Existing package.json found"
          fi
          
      - name: Success Completion
        run: echo "ðŸŽ‰ Validation completed successfully!"
